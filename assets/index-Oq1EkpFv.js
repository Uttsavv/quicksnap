(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const n of c)if(n.type==="childList")for(const m of n.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&g(m)}).observe(document,{childList:!0,subtree:!0});function i(c){const n={};return c.integrity&&(n.integrity=c.integrity),c.referrerPolicy&&(n.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?n.credentials="include":c.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function g(c){if(c.ep)return;c.ep=!0;const n=i(c);fetch(c.href,n)}})();const d=document.querySelector("[recording-button]"),S=document.getElementById("audio"),w=document.getElementById("facecam"),C=document.getElementById("screen"),r=document.querySelector("[output-canvas]"),s=r.getContext("2d");let u=null,o=null,a=null;const f=document.createElement("video"),l=document.createElement("video");f.autoplay=!0;l.autoplay=!0;function p(){return{audio:S.checked,screen:C.checked,facecam:w.checked}}function v(e){const t=p();let i={audio:t.audio,video:{}};return e==="screen"&&t.screen?i.video={width:720,height:480}:e==="facecam"&&t.facecam&&(i.video={width:720/4,height:480/4}),i}d==null||d.addEventListener("click",()=>{!o&&!a?E():I()});async function E(){d.textContent="Stop Recording",r.classList.remove("hidden");const e=p();try{e.facecam&&(await L(),o&&h(o,f)),e.screen&&(await b(),a&&h(a,l)),O()}catch(t){console.error("Error accessing media devices:",t)}}async function L(){try{o=await navigator.mediaDevices.getUserMedia(v("facecam"))}catch(e){console.error(e)}}async function b(){try{a=await navigator.mediaDevices.getDisplayMedia(v("screen"))}catch(e){console.error(e)}}function I(){o&&(y(o),o=null),a&&(y(a),a=null),x(),u&&(cancelAnimationFrame(u),u=null)}function h(e,t){t&&(t.srcObject=e)}function y(e){e.getTracks().forEach(t=>t.stop())}function x(){d&&(d.textContent="Start Recording"),s&&(s.reset(),r.classList.add("hidden"))}function O(){function e(){if(s){if(s.clearRect(0,0,r.width,r.height),a&&l.readyState>=2&&s.drawImage(l,0,0,r.width,r.height),o&&f.readyState>=2){const t=r.width/4,i=r.height/4;s.drawImage(f,r.width-t-10,r.height-i-10,t,i)}u=requestAnimationFrame(e)}}e()}
