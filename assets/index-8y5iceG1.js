(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const g of o.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();const u=document.querySelector("[recording-button]"),S=document.getElementById("audio"),C=document.getElementById("facecam"),L=document.getElementById("screen"),r=document.querySelector("[output-canvas]"),d=r.getContext("2d");let f=null,a=null,i=null,s=null,p=[];const m=document.createElement("video"),h=document.createElement("video");m.autoplay=!0;h.autoplay=!0;function w(){return{audio:S.checked,screen:L.checked,facecam:C.checked}}function b(c){const t=w();let n={audio:t.audio,video:{}};return c==="screen"&&t.screen?n.video={width:1920,height:1080}:c==="facecam"&&t.facecam&&(n.video={width:720,height:480}),n}u==null||u.addEventListener("click",()=>{!a&&!i?R():I()});async function R(){u.textContent="Stop Recording",r.classList.remove("hidden");const c=w();try{c.facecam&&(await E(),a&&y(a,m)),c.screen&&(await O(),i&&y(i,h));const t=r.captureStream(30);s=new MediaRecorder(t),s.ondataavailable=n=>{n.data.size>0&&p.push(n.data)},s.onstop=()=>{const n=new Blob(p,{type:"video/webm"}),l=URL.createObjectURL(n),e=document.createElement("a");e.style.display="none",e.href=l,e.download="recording.webm",document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(l),p=[]},s.start(),x()}catch(t){console.error("Error accessing media devices:",t)}}async function E(){try{a=await navigator.mediaDevices.getUserMedia(b("facecam"))}catch(c){console.error(c)}}async function O(){try{i=await navigator.mediaDevices.getDisplayMedia(b("screen"))}catch(c){console.error(c)}}function I(){s&&(s.stop(),s=null),a&&(v(a),a=null),i&&(v(i),i=null),k(),f&&(cancelAnimationFrame(f),f=null)}function y(c,t){t&&(t.srcObject=c)}function v(c){c.getTracks().forEach(t=>t.stop())}function k(){u&&(u.textContent="Start Recording"),d&&(d.reset(),r.classList.add("hidden"))}function x(){function c(){if(d){if(d.clearRect(0,0,r.width,r.height),i&&h.readyState>=2&&d.drawImage(h,0,0,r.width,r.height),a&&m.readyState>=2){const t=r.width/4,n=r.height/4;d.drawImage(m,r.width-t-10,r.height-n-10,t,n)}f=requestAnimationFrame(c)}}c()}
